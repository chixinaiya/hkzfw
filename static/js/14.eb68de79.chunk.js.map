{"version":3,"sources":["pages/Rent/Search/index.module.css","pages/Rent/Search/index.js"],"names":["module","exports","Search","state","searchTxt","tipsList","renderTips","map","item","onClick","props","history","replace","pathname","data","id","community","name","communityName","key","className","styles","tip","handlerSearch","v","val","trim","length","setState","a","getCommunity","cityId","status","getCurCity","value","this","root","placeholder","onChange","showCancelButton","onCancel","tips","Component"],"mappings":"oFACAA,EAAOC,QAAU,CAAC,KAAO,qBAAqB,KAAO,qBAAqB,UAAY,0BAA0B,KAAO,qBAAqB,IAAM,sB,wNCQ7HC,E,4MACnBC,MAAQ,CAENC,UAAW,GACXC,SAAU,I,EAUZC,WAAa,WAGX,OAFqB,EAAKH,MAAlBE,SAEQE,KAAI,SAACC,GAAD,OAClB,wBACEC,QAAS,WACP,EAAKC,MAAMC,QAAQC,QAAQ,CACzBC,SAAU,YACVC,KAAM,CAAEC,GAAIP,EAAKQ,UAAWC,KAAMT,EAAKU,kBAG3CC,IAAKX,EAAKQ,UACVI,UAAWC,IAAOC,KAEjBd,EAAKU,mB,EAMZK,cAAgB,SAACC,GACf,IAAIC,EAAMD,EAAEE,OAEZ,GAAmB,IAAfD,EAAIE,OACN,OAAO,EAAKC,SAAS,CACnBxB,UAAW,GACXC,SAAU,KAGd,EAAKuB,SACH,CACExB,UAAWqB,GAFf,sBAIE,gCAAAI,EAAA,sEAEiCC,YAAa,EAAKC,OAAQN,GAF3D,gBAEUO,EAFV,EAEUA,OAAQlB,EAFlB,EAEkBA,KACD,MAAXkB,GAEF,EAAKJ,SAAS,CACZvB,SAAUS,IANhB,6C,oMAtCsBmB,c,gBAAhBC,E,EAAAA,MACRC,KAAKJ,OAASG,E,qIAkDN,IACAvB,EAAYwB,KAAKzB,MAAjBC,QACAP,EAAc+B,KAAKhC,MAAnBC,UAER,OACE,yBAAKgB,UAAWC,IAAOe,MAErB,uBACEC,YAAY,mDACZH,MAAO9B,EACPkC,SAAUH,KAAKZ,cACfgB,kBAAkB,EAClBC,SAAU,kBAAM7B,EAAQC,QAAQ,gBAIlC,wBAAIQ,UAAWC,IAAOoB,MAAON,KAAK7B,mB,GA5ENoC","file":"static/js/14.eb68de79.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"root\":\"Search_root__14Ol7\",\"list\":\"Search_list__6x-0I\",\"noHistory\":\"Search_noHistory__2wiU1\",\"tips\":\"Search_tips__3c_Yq\",\"tip\":\"Search_tip__2yMRo\"};","import React, { Component } from \"react\";\r\n\r\nimport { SearchBar } from \"antd-mobile\";\r\n\r\nimport { getCurCity } from \"../../../utils\";\r\n\r\nimport styles from \"./index.module.css\";\r\nimport { getCommunity } from \"../../../utils/api/City\";\r\n\r\nexport default class Search extends Component {\r\n  state = {\r\n    // 搜索框的值\r\n    searchTxt: \"\",\r\n    tipsList: [],\r\n  };\r\n\r\n  async componentDidMount() {\r\n    // 获取城市ID\r\n    const { value } = await getCurCity();\r\n    this.cityId = value;\r\n  }\r\n\r\n  // 渲染搜索结果列表\r\n  renderTips = () => {\r\n    const { tipsList } = this.state;\r\n\r\n    return tipsList.map((item) => (\r\n      <li\r\n        onClick={() => {\r\n          this.props.history.replace({\r\n            pathname: \"/rent/add\",\r\n            data: { id: item.community, name: item.communityName },\r\n          });\r\n        }}\r\n        key={item.community}\r\n        className={styles.tip}\r\n      >\r\n        {item.communityName}\r\n      </li>\r\n    ));\r\n  };\r\n\r\n  // 搜素框受控\r\n  handlerSearch = (v) => {\r\n    let val = v.trim();\r\n    // 处理为空的情况\r\n    if (val.length === 0) {\r\n      return this.setState({\r\n        searchTxt: \"\",\r\n        tipsList: [],\r\n      });\r\n    }\r\n    this.setState(\r\n      {\r\n        searchTxt: val,\r\n      },\r\n      async () => {\r\n        // 根据关键词搜索小区\r\n        const { status, data } = await getCommunity(this.cityId, val);\r\n        if (status === 200) {\r\n          // 显示搜索结果\r\n          this.setState({\r\n            tipsList: data,\r\n          });\r\n        }\r\n      }\r\n    );\r\n  };\r\n\r\n  render() {\r\n    const { history } = this.props;\r\n    const { searchTxt } = this.state;\r\n\r\n    return (\r\n      <div className={styles.root}>\r\n        {/* 搜索框 */}\r\n        <SearchBar\r\n          placeholder=\"请输入小区或地址\"\r\n          value={searchTxt}\r\n          onChange={this.handlerSearch}\r\n          showCancelButton={true}\r\n          onCancel={() => history.replace(\"/rent/add\")}\r\n        />\r\n\r\n        {/* 搜索提示列表 */}\r\n        <ul className={styles.tips}>{this.renderTips()}</ul>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n"],"sourceRoot":""}